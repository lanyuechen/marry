(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{"+n12":function(t,e,n){"use strict";function a(){let t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";return t=t.replace(/x/g,(function(){const t=16*Math.random()|0;return t.toString(16)})),t=t.replace("y",(16*Math.random()&3|8).toString(16)),t.replace(/-/g,"").substr(0,24)}function r(t,e){let n;return function(){n&&clearTimeout(n),n=setTimeout((()=>{t(...arguments)}),e)}}async function i(t){const e=await fetch(`./templates/${t}.json`);return e.json()}n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}))},4469:function(t,e,n){"use strict";n.d(e,"c",(function(){return p})),n.d(e,"a",(function(){return f})),n.d(e,"b",(function(){return h})),n.d(e,"e",(function(){return b})),n.d(e,"d",(function(){return g}));var a=n("XS3J"),r=n.n(a),i=n("+n12");const c="marry.db",o=Symbol.for("db-instance-key");class s{loadDatabase(t,e){try{const n=localStorage.getItem(t);e(n)}catch(n){e(n)}}saveDatabase(t,e,n){try{localStorage.setItem(t,e),n(null)}catch(a){n(a)}}}const l=new s;class u{static getInstance(){return window[o]||(window[o]=new u),window[o]}constructor(){this.db=new r.a(c,{env:"BROWSER",autosave:!0,adapter:l}),this.db.loadDatabase()}table(t){return this.collection=this.db.getCollection(t)||this.db.addCollection(t),this}find(t={}){return this.collection.find(t)}findOne(t={}){return this.collection.findOne(t)}insert(t){const e=Object(i["c"])();return this.collection.insert({...t,_id:e}),e}update(t={},e){this.collection.findAndUpdate(t,(t=>{e="function"===typeof e?e(t):e,Object.assign(t,e)}))}delete(t={}){this.collection.findAndRemove(t)}}var d=u.getInstance();const m="story";async function p(t){const e=d.table(m).find(t);return{success:!0,data:e}}async function f(t){const e=d.table(m).findOne({_id:t});return{success:!0,data:e}}async function h(t){const e=d.table(m).insert(t);return{success:!0,data:{_id:e}}}async function b(t,e){return d.table(m).update({_id:t},e),{success:!0}}async function g(t){return d.table(m).delete({_id:t}),{success:!0}}},AF1r:function(t,e,n){"use strict";var a=n("R+Pm");const r=Object(a["a"])({scriptUrl:["//at.alicdn.com/t/font_2652076_5epk3ej1ofs.js","//at.alicdn.com/t/font_2724754_rcmb540ie.js"]});e["a"]=r},AKB2:function(t,e,n){"use strict";var a=n("0Owb"),r=n("tJVT"),i=n("q1tI"),c=n.n(i),o=n("xqva"),s=n("Ndxo"),l=n("yerw"),u=n.n(l),d=t=>{const e=t.background,n=t.children;return c.a.createElement("div",{className:u.a.container,style:{background:e}},n)},m=n("Pv/L"),p=n("EgnG"),f=n("B2N0"),h=t=>{const e=t.id,n=t.path,a=t.scale,r=t.size,o=t.viewBox,s=void 0===o?"0 0 1024 1024":o,l=Object(i["useMemo"])((()=>{const t=r[0],e=r[1],n=s.split(" "),i=n[2]/n[3];let c,o;i>t/e?(c=t*a,o=c/i):(o=e*a,c=o*i);const l=(t-c)/2,u=(e-o)/2,d=c/n[2];return`translate(${l}, ${u}) scale(${d})`}),[]);return c.a.createElement("svg",{width:"0",height:"0",viewBox:s,xmlns:"http://www.w3.org/2000/svg",version:"1.1"},c.a.createElement("defs",null,c.a.createElement("clipPath",{id:e,transform:l},c.a.createElement("path",{d:n,"p-id":"2011"}))))},b=n("xDV/"),g=n.n(b),x=t=>{const e=t.position,n=t.size,r=t.rotation,o=t.clip,s=t.entrance,l=t.animation,u=void 0===l?{}:l,d=t.children,b=Object(i["useRef"])(),x=Object(i["useRef"])(),w=Object(f["d"])(u,{position:e,size:n,rotation:r}),y=Object(m["a"])(w),E=y[0],v=y.slice(1),O=Object(f["c"])(E);return Object(i["useEffect"])((()=>{v.length&&(s?x.current?(x.current.reverse(),x.current.play()):x.current=Object(p["a"])({targets:b.current,duration:u.duration||1e3,delay:u.delay||0,easing:"easeInOutSine",keyframes:v}):x.current&&(x.current.reverse(),x.current.play()))}),[s]),c.a.createElement("div",{ref:b,className:g.a.container,style:{...O,clipPath:o&&`url(#${o.id})`}},d,o&&c.a.createElement(h,Object(a["a"])({},o,{size:n})))},w=n("AF1r"),y=n("zPdC"),E=n.n(y),v=t=>{const e=t.src,n=(t.autoPlay,Object(i["useRef"])()),a=Object(i["useState"])(!0),o=Object(r["a"])(a,2),s=o[0],l=o[1],u=()=>{n.current.paused?d():m()},d=()=>{l(!1),n.current.volume=0,n.current.play(),Object(p["a"])({targets:n.current,easing:"linear",duration:2e3,volume:1})},m=()=>{l(!0),n.current.volume=1,Object(p["a"])({targets:n.current,easing:"linear",duration:2e3,volume:0,complete:()=>{n.current.pause()}})};return c.a.createElement("div",{className:E.a.container,onClick:u},c.a.createElement(w["a"],{type:"icon-music",className:""+(s?"":"spin")}),c.a.createElement("audio",{ref:n,src:e,loop:!0}))},O=n("o3J1"),_=n.n(O),j=t=>{const e=t.src,n=t.size,a=t.crop,r=Object(i["useMemo"])((()=>{if(a){const t=a.areaPixel.width/a.area.width*100,e=a.areaPixel.height/a.area.height*100,r=Math.max(n[0]/a.areaPixel.width,n[1]/a.areaPixel.height);return{width:t*r/a.zoom,height:e*r/a.zoom,transform:`\n          translate(-50%, -50%)\n          scale(${a.zoom})\n          translate(${50-a.area.x}%, ${50-a.area.y}%)\n          rotate(${a.rotation}deg)\n        `}}}),[a]);return c.a.createElement("img",{className:_.a.image,style:r,src:e,alt:"img"})},I=n("Y7CS"),z=n.n(I),k=t=>{const e=t.value;return c.a.createElement("div",{className:z.a.container},e)},C=n("uQII"),S={image:j,text:k,icon:C["b"]},Y=n("OI9A"),$=n.n(Y);e["a"]=t=>{const e=t.data,n=t.editable,l=t.onEdit,u=Object(i["useState"])(0),m=Object(r["a"])(u,2),p=m[0],h=m[1],b=Object(i["useMemo"])((()=>Object(f["a"])(e)),[e]);return c.a.createElement(c.a.Fragment,null,b.audio&&c.a.createElement(v,b.audio),c.a.createElement(o["a"],{style:{height:"100%"},autoplay:b.transition.autoPlay&&{delay:b.transition.duration||3e3},direction:b.transition.direction,effect:b.transition.effect,onSlideChangeTransitionEnd:t=>h(t.activeIndex)},b.pages.map(((t,e)=>c.a.createElement(s["a"],{key:t.id},c.a.createElement(d,{background:t.background},t.elements&&t.elements.map(((t,r)=>{const i=S[t.type];return c.a.createElement(x,{key:r,entrance:p===e,position:t.position,size:t.size,rotation:t.rotation,clip:t.clip,animation:!n&&t.animation},c.a.createElement(i,Object(a["a"])({},t.props,{size:t.size})),n&&l&&c.a.createElement("button",{className:$.a.btn,onClick:()=>l(e,r)},c.a.createElement(w["a"],{type:"icon-edit"})))}))))))))}},B2N0:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"d",(function(){return u})),n.d(e,"c",(function(){return d}));var a=n("PpiC"),r=n("+n12"),i={cat:"M518.25664 993.28h-0.4096c-49.03936 0-99.67616-6.47168-150.528-19.22048-52.61312-13.19936-92.57984-29.9008-116.84864-41.60512-58.7776-28.2112-111.47264-67.82976-152.35072-114.55488-41.41056-47.31904-71.24992-102.56384-86.30272-159.744a353.46432 353.46432 0 0 1-5.9904-154.5216c9.6256-52.8384 31.1296-104.20224 63.88736-152.73984l1.3312-5.07904c39.3216-150.08768 79.98464-305.27488 182.67136-324.1472l1.20832-0.21504 1.2288-0.12288A182.55872 182.55872 0 0 1 273.69472 20.48c99.7376 0 169.97376 81.6128 194.48832 114.93376h81.408l2.048-2.4576c27.66848-33.44384 92.4672-111.75936 183.296-111.75936h1.47456c107.37664 0 171.61216 185.3952 210.5856 324.84352 1.3312 4.78208 2.70336 9.6768 3.62496 12.82048 64.12288 94.60736 86.3744 189.41952 66.12992 281.87648-35.1232 160.44032-185.92768 255.08864-200.83712 264.09984C803.4304 913.37728 689.152 988.3136 518.67648 993.28l-0.41984 0.01024z",star:"M437.086316 85.423158L321.589895 287.744l-224.471579 49.690947c-16.384 3.610947-31.528421 11.317895-44.193684 22.312421l-6.413474 6.25179-5.928421 7.006316a99.920842 99.920842 0 0 0 2.96421 127.622737l154.138948 176.128-23.228632 234.873263c-1.724632 17.354105 1.131789 34.923789 8.29979 50.822737l3.772631 7.491368 4.688842 7.383579a99.920842 99.920842 0 0 0 123.526737 35.193263l209.057684-94.208 209.111579 94.154105c15.898947 7.168 33.414737 10.078316 50.768842 8.353685l8.29979-1.239579 8.461474-2.048a99.920842 99.920842 0 0 0 72.757894-105.903158l-23.390315-234.873263 154.246736-176.128c11.048421-12.611368 18.701474-27.809684 22.312421-44.193685l1.455158-8.245894 0.646737-8.677053c1.778526-48.882526-30.666105-91.621053-77.985684-102.076632L725.962105 287.797895l-115.388631-202.320842a99.813053 99.813053 0 0 0-173.433263 0z",leaf:"M946.618 826.575c60.125-157.837 21.743-390.212-60.125-488.534-285.605-315.665-533.628-52.612-533.628-52.612-180.381-120.255-269.178-77.878-312.514-30.062-26.723 37.581 11.876 90.19 11.876 90.19 48.849 54.492 99.584-31.943 255.538 37.581-75.161 511.082 638.852 443.431 638.852 443.431z"};e["a"]=t=>({...t,transition:t.transition||{direction:"vertical",effect:"slide"},pages:t.pages.map(c)});const c=t=>({...t,id:Object(r["c"])(),elements:t.elements.map(o)}),o=t=>({...t,position:[l(t.position[0],window.innerWidth),l(t.position[1],window.innerHeight)],size:[l(t.size[0],window.innerWidth),l(t.size[1],window.innerHeight)],clip:s(t.clip)}),s=t=>{if(t)return"string"===typeof t?i[t]&&{id:Object(r["c"])(),path:i[t]}:{...t,id:Object(r["c"])(),path:i[t.path]||t.path}},l=(t,e)=>t&&"number"!==typeof t?/px$/.test(t)?parseFloat(t):(/%$/.test(t),e*parseFloat(t)/100):t,u=(t,e)=>{t=t||{};const n=e.position,a=e.size,r=e.rotation,i=l(a[0],window.innerWidth),c=l(a[1],window.innerHeight),o={slideInLeft:{translateX:-i,translateY:n[1]},slideInTop:{translateX:n[0],translateY:-c},slideInRight:{translateX:window.innerWidth+i,translateY:n[1]},slideInBottom:{translateX:n[0],translateY:window.innerHeight+c},slideInLeftTop:{translateX:-i,translateY:-c},slideInRightTop:{translateX:window.innerWidth+i,translateY:-c},slideInLeftBottom:{translateX:-i,translateY:window.innerHeight+c},slideInRightBottom:{translateX:window.innerWidth+i,translateY:window.innerHeight+c}};let s=[];return o[t.type]?s.push({...o[t.type],width:a[0],height:a[1]}):t.keyframes&&s.push(...t.keyframes),s.push({translateX:n[0],translateY:n[1],rotate:r,width:a[0],height:a[1]}),s},d=t=>{if(!t)return;const e=t.translateX,n=void 0===e?0:e,r=t.translateY,i=void 0===r?0:r,c=t.rotate,o=void 0===c?0:c,s=Object(a["a"])(t,["translateX","translateY","rotate"]);return{...s,transform:`translateX(${n}px) translateY(${i}px) rotate(${o}deg)`}}},DSRp:function(t,e,n){"use strict";n.r(e);n("+L6B");var a=n("2/Rp"),r=n("tJVT"),i=n("q1tI"),c=n.n(i),o=n("9kvl"),s=n("AKB2"),l=n("AF1r"),u=n("EID/"),d=n("+n12"),m=n("4469");e["default"]=t=>{const e=t.match.params.id,n=Object(i["useState"])(),p=Object(r["a"])(n,2),f=p[0],h=p[1];if(Object(i["useEffect"])((()=>{Object(d["b"])(e).then((t=>{h(t)}))}),[e]),!f)return null;const b=()=>{o["a"].goBack()},g=async()=>{const t=await m["b"](f);t.success&&o["a"].push(`/editor/${t.data._id}`)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(s["a"],{data:f}),c.a.createElement(u["a"],null,c.a.createElement(a["a"],{shape:"circle",onClick:b},c.a.createElement(l["a"],{type:"icon-back"})),c.a.createElement(a["a"],{shape:"circle",onClick:g},c.a.createElement(l["a"],{type:"icon-edit"}))))}},E6o7:function(t,e,n){t.exports={container:"container___39CpX"}},"EID/":function(t,e,n){"use strict";n("DYRE");var a=n("zeV3"),r=n("q1tI"),i=n.n(r),c=n("a7FC"),o=n.n(c);e["a"]=t=>i.a.createElement(a["b"],{className:o.a.tool,direction:"vertical"},t.children)},OI9A:function(t,e,n){t.exports={btn:"btn___17Bbr"}},Y7CS:function(t,e,n){t.exports={container:"container___36LYG"}},a7FC:function(t,e,n){t.exports={tool:"tool___DFddu"}},o3J1:function(t,e,n){t.exports={image:"image___dicno"}},uQII:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var a=n("q1tI"),r=n.n(a),i=n("R+Pm"),c=n("E6o7"),o=n.n(c);const s=Object(i["a"])({scriptUrl:["//at.alicdn.com/t/font_2724754_rcmb540ie.js"]});e["b"]=t=>{const e=t.type,n=t.size;return r.a.createElement("div",{className:o.a.container},r.a.createElement(s,{type:`icon-${e}`,style:{fontSize:Math.min(n[0],n[1])}}))}},"xDV/":function(t,e,n){t.exports={container:"container___2Wfau"}},yerw:function(t,e,n){t.exports={container:"container___2CKxV"}},zPdC:function(t,e,n){t.exports={container:"container___3l3x7",spin:"spin___3DLuw"}}}]);